{
  "hooks": {
    "SessionStart": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/session-start.sh",
            "timeout": 5000
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Task",
        "hooks": [
          {
            "type": "command",
            "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/gate-task-tool.sh",
            "timeout": 5000
          },
          {
            "type": "command",
            "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/block-subagent-task.sh",
            "timeout": 5000
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "AskUserQuestion",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Analyze the user's response to determine their intent regarding plan approval.\n\nContext: During the PLAN_WAITING phase of orchestrated workflow, users are asked to approve implementation plans before subagent delegation begins.\n\nClassify the user's response as one of:\n\n1. APPROVED - User clearly approves (examples: \"yes\", \"go ahead\", \"looks good\", \"proceed\", \"approved\", \"let's do it\", \"sure\", \"sounds good\", \"LGTM\", or any affirmative without conditions)\n\n2. REJECTED - User clearly rejects or wants to cancel (examples: \"no\", \"stop\", \"cancel\", \"don't\", \"reject\", \"start over\", or clear refusal)\n\n3. MODIFICATION_REQUESTED - User approves conditionally or wants changes (examples: \"yes but...\", \"approve with changes\", \"almost, but...\", contains conditions or modifications)\n\n4. UNCLEAR - Response is ambiguous or unrelated to approval\n\nIMPORTANT: If the response indicates APPROVED during PLAN_WAITING phase:\n- Write 'approved' to .claude/plan-approved file\n- Update .claude/workflow-phase to 'DELEGATE'\n- Proceed with subagent delegation\n\nIf REJECTED:\n- Update .claude/workflow-phase to 'IDLE'\n- Ask user how they'd like to proceed\n\nIf MODIFICATION_REQUESTED:\n- Keep .claude/workflow-phase as 'PLAN_WAITING'\n- Address the user's requested changes to the plan\n\nIf UNCLEAR:\n- Ask for clarification on whether to proceed\n\nConsider context, tone, and conditional language. Handle international variations and casual speech patterns.",
            "timeout": 20000
          }
        ]
      }
    ],
    "PreCompact": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Before compacting context, preserve these critical elements:\n\n1. KEY DECISIONS: Any architectural decisions, technology choices, or design patterns chosen\n2. BUGS/ISSUES FOUND: Any bugs discovered during implementation that need attention\n3. CRITICAL FILE PATHS: Files that were modified or are essential for current task\n4. CURRENT TASK STATE: What step are we on? What's next?\n5. INTERFACE CONTRACTS: Any APIs or interfaces that were defined\n\nDO NOT preserve:\n- Exploratory file reads that led nowhere\n- Superseded approaches that were abandoned\n- Verbose error messages (keep just the error type)\n\nAfter compaction, immediately re-read todo.md and progress.txt to restore external state."
          }
        ]
      }
    ],
    "SubagentStop": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/verify-subagent-complete.sh",
            "timeout": 30000
          },
          {
            "type": "prompt",
            "prompt": "Before allowing this subagent to complete, verify:\n\n1. TASK PACKET OBJECTIVE: Was the single clear goal achieved?\n2. SUCCESS CRITERIA: Are all measurable criteria met?\n3. ARTIFACT WRITTEN: Was a summary artifact written to .claude/artifacts/?\n4. TESTS PASSING: Did the subagent run and pass relevant tests?\n5. SCOPE RESPECTED: Did subagent stay within defined file scope?\n\nIf any criteria not met, instruct subagent to continue with specific guidance on what's missing."
          }
        ]
      }
    ],
    "Stop": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/verify-complete.sh",
            "timeout": 120000
          }
        ]
      }
    ]
  }
}
